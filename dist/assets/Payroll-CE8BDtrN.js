import{s as k}from"./index-BdlwmbEA.js";import{b as D,c as V}from"./index-kMO2B_2Z.js";import{_ as x}from"./Vuelidate-D58-4aDa.js";import{s as E}from"./index-D3TYj3W6.js";import{s as C}from"./index-BZEh9QIP.js";import{d as L,_ as T}from"./Default-rdowlBa5.js";import{_ as B,E as r,c,b as o,w as d,o as p,a as t,t as I,k as h,s as j}from"./index-IT0w0-03.js";import{_ as S}from"./PageHeader-BmhK7qIL.js";import{u as A}from"./index-Cn83LMNj.js";import{r as u}from"./index-DhnhZP77.js";import"./index-Co2kFwYe.js";import"./index-J9SwwLSJ.js";import"./index-D1kxKiUG.js";import"./index-D0k6Dizi.js";import"./index-BdwjZwyA.js";import"./index-CKMnAYYC.js";const N={name:"AdminPayroll",inject:["default"],data(){return{isLoading:!0,visiblePayrollDialog:!1,dataPayroll:[],columns:[{field:"nama_pegawai",header:"Nama Pegawai"},{field:"periode",header:"Periode"},{field:"total_gaji",header:"Total Gaji"}],pegawai:null,daftarPegawai:null,phPegawai:"Loading...",loadingPegawai:!0,v$:A(),hasValidated:!1,formPost:!1,id_payroll:null,pegawai:null,potongan:null,formIsLoading:!1,dialogTitle:""}},validations(){return{id_pegawai:{required:u},potongan:{required:u}}},methods:{async getPayroll(){await r.get("/payroll").then(l=>{this.dataPayroll=l.data.data,this.isLoading=!1}).catch(l=>{console.log(l)})},togglePayrollDialog(){this.visiblePayrollDialog=!this.visiblePayrollDialog},handleDelete(l){L("/payroll",l),this.getPayroll()},handleEdit(l){this.id_payroll=l,this.formIsLoading=!0,this.dialogTitle="Edit Payroll Pegawai",this.formPost=!1,this.getPegawaiAll(),this.togglePayrollDialog(),this.getPayrollById(l)},openPost(){this.formPost=!0,this.pegawai=null,this.potongan=null,this.togglePayrollDialog(),this.dialogTitle="Tambahkan Payroll Pegawai",this.getPegawaiAll()},async post(){this.togglePayrollDialog(),this.hasValidated=!0;const l={id_pegawai:this.pegawai.id_pegawai,potongan:this.potongan};await r.post("/payroll",l).then(a=>{this.$toast.add({severity:"success",summary:"Success",detail:a.data.message,life:3e3}),this.getPayroll()}).catch(a=>{console.log(a),this.$toast.add({severity:"error",summary:"Error",detail:a,life:3e3})})},async edit(l){this.togglePayrollDialog();const a={id_pegawai:this.pegawai.id_pegawai,potongan:this.potongan};await r.patch("payroll/"+l,a).then(g=>{this.visible=!1,this.$toast.add({severity:"info",summary:"Edit Berhasil",detail:`Payroll ${g.data.data.nama_pegawai} Berhasil Di Edit`,life:3e3}),this.getPayroll()}).catch(g=>{console.log(g)})},async getPegawaiAll(){try{const l=await r.get("pegawai");this.daftarPegawai=l.data.data,this.loadingPegawai=!1,this.phPegawai="Pilih pegawai"}catch(l){console.log("Error:"+l),this.phPegawai="Error",this.loadingPegawai=!1}},async getPayrollById(l){await r.get("payroll/"+l).then(a=>{this.potongan=a.data.data.potongan,this.pegawai=a.data.data.pegawai,this.phPegawai=a.data.data.nama_pegawai,this.formIsLoading=!1}).catch(a=>{console.log(a)})}},mounted(){this.getPayroll()}},O={class:"grid grid-cols-12 m-5 gap-5 mb-24 lg:mb-5"},U={class:"flex justify-between"},q={class:"flex gap-2"},G={key:0,class:"grid grid-cols-12 gap-5 h-96 m-5"},H={class:"col-span-12 w-full flex justify-center items-center"},M={key:1,class:"p-7 overflow-auto"},z={class:"w-full grid grid-cols-8 gap-2"},F={class:"col-span-12 text-xl mb-6 font-semibold"},J={class:"flex justify-end gap-2"};function K(l,a,g,Q,e,i){const _=S,n=j,y=T,P=C,f=E,w=D,m=x,b=V,v=k;return p(),c("div",O,[o(_,{title:"Payroll"}),o(P,{class:"col-span-12 shadow-md"},{title:d(()=>[t("div",U,[a[4]||(a[4]=t("h3",null,"Daftar Payroll Pegawai",-1)),t("div",q,[o(n,{icon:"pi pi-plus-circle",label:"Tambah Payroll",onClick:i.openPost},null,8,["onClick"]),o(n,{icon:"pi pi-external-link",label:"Export",onClick:a[0]||(a[0]=s=>l.exportCSV(s))})])])]),content:d(()=>[o(y,{columns:e.columns,dataLuar:e.dataPayroll,onOpenDelete:i.handleDelete,onOpenEdit:i.handleEdit,api:"/payroll",id:"id_payroll"},null,8,["columns","dataLuar","onOpenDelete","onOpenEdit"])]),_:1}),o(v,{visible:e.visiblePayrollDialog,modal:"",header:"Tambah Payroll Pegawai",style:{width:"70rem"}},{container:d(()=>[e.formIsLoading?(p(),c("div",G,[t("div",H,[o(f)])])):(p(),c("div",M,[t("form",z,[t("p",F,I(e.dialogTitle),1),o(m,{name:"nama_lengkap",label:"Pilih Pegawai",hasValidated:e.hasValidated},{default:d(()=>[o(w,{class:"col-span-12 max-h-[46px]",disabled:!e.formPost,modelValue:e.pegawai,"onUpdate:modelValue":a[1]||(a[1]=s=>e.pegawai=s),options:e.daftarPegawai,optionLabel:"nama_lengkap",loading:e.loadingPegawai,placeholder:e.phPegawai,filter:""},null,8,["disabled","modelValue","options","loading","placeholder"])]),_:1},8,["hasValidated"]),o(m,{name:"potongan",label:"Potongan",hasValidated:e.hasValidated},{default:d(()=>[o(b,{id:"potongan",modelValue:e.potongan,"onUpdate:modelValue":a[2]||(a[2]=s=>e.potongan=s),class:"col-span-12 max-h-[46px]",invalid:e.hasValidated&&e.v$.name.$invalid,placeholder:"Masukkan potongan gaji pegawai"},null,8,["modelValue","invalid"])]),_:1},8,["hasValidated"])]),t("div",J,[o(n,{type:"button",label:"Cancel",severity:"secondary",onClick:i.togglePayrollDialog},null,8,["onClick"]),e.id_payroll?(p(),h(n,{key:0,type:"button",label:"Edit",onClick:a[3]||(a[3]=s=>i.edit(e.id_payroll))})):(p(),h(n,{key:1,type:"button",label:"Tambahkan",onClick:i.post},null,8,["onClick"]))])]))]),_:1},8,["visible"])])}const pa=B(N,[["render",K]]);export{pa as default};
